

    <div>
        <!-- kk -->
        
            <div style="display:flex;flex-grow: 1;position:fixed;z-index:100;top:.5%;left:30%;right:0px;">
                <button class="btn btn-primary margin-left" type="button" (click)="addResources()" 
                title="Add resource to your workspace. Resource will appear at top of list"> Add Resource </button>
                <button [disabled]="!this.mainForm.dirty" type="button" class="btn btn-primary margin-left"  (click)="savePlans(fromDate,toDate,timescale,workunits)" 
                title="Save and Publish your changes">
                Submit </button>
                <button [disabled]="!this.AnyResPlanSelectedForDelete()" type="button" class="btn btn-primary margin-left" (click)="deleteResPlans(fromDate,toDate,timescale,workunits,false)" 
                title="Permanently delete resource plan assignments from selected project(s)">
                Delete </button>
                <button [disabled]="!this.AnyResPlanSelectedForHide()" type="button" class="btn btn-primary margin-left" (click)="deleteResPlans(fromDate,toDate,timescale,workunits,true)" 
                title="Remove resource from your workspace without deleting assignment">
                Hide </button>
            </div>
        

        <form class="form-horizontal" novalidate [formGroup]="mainForm">

            <div formArrayName="resPlans" *ngIf="resPlans && resPlans.length">
                <res-plan-header-row #header (onselectAllChanged)="toggleSelectAll($event)"></res-plan-header-row>
                <div class="table-body">
                    <table class="table">
                        <tbody *ngFor="let plan of resPlans.controls;index as i" >

                            <div [formGroupName]="i">
                                <collapsible-well>
                                    <div well-title>
                                        <tr>
                                            <td class="body-cell" style="padding-left:5px">
                                                <input type="checkbox" formControlName="selected" (click)="toggleResPlanSelection(plan,$event.target.checked)" />
                                            </td>



                                            <td class="body-cell col1">
                                                <input class = "totalsRow" formControlName="resName" placeholder="First name" style="width:100%">
                                            </td>
                                            <div formArrayName="totals">
                                                <td class="body-cell col" *ngFor="let total of plan.get('totals').controls;index as l"  >
                                                    <div [formGroupName]="l">
                                                        <input #totalVal class ="totalsRow" [ngClass] = "checkTotal(totalVal.value)"  formControlName="intervalValue" placeholder="intervalValue" style="width:100%" /> 
                                                        


                                                    </div>
                                                </td>

                                            </div>
                                            <input formControlName="resUid" placeholder="id" style='display:none'>
                                        </tr>
                                    </div>
                                    <div well-body>
                                        <div formArrayName="projects">
                                            <div *ngFor="let proj of plan.get('projects').controls;index as j">
                                                <tr [formGroupName]="j">
                                                    <td class="body-cell" style="padding-left:5px">
                                                        <input type="checkbox" formControlName="selected" (click)="DeselectGroupOnUncheck(plan,$event.target.checked)" />
                                                    </td>




                                                    <td class="body-cell col1">
                                                        <input formControlName="projName" placeholder="project" style="width:100%" />
                                                        <message [message]="proj.get('readOnlyReason').value" *ngIf="proj.get('readOnly').value"></message>
                                                        <error [error]="proj.get('error').value" *ngIf="proj.get('error').value != null"></error>
                                                    </td>
                                                    <div formArrayName="intervals">
                                                        <td class="body-cell col" *ngFor="let intrvl of proj.get('intervals').controls; index as k">
                                                            <div [formGroupName]="k">
                                                                <input [ngClass]="intrvl.get('intervalValue').dirty && 'dirtyCell'" type="number" min="0" onClick="this.select()" autofocus 
                                                                formControlName="intervalValue" style="width:100%" [value]="intrvl.get('intervalValue').value">
                                                            </div>
                                                        </td>
                                                    </div>
                                                </tr>
                                            </div>
                                            <!-- i = index of resplan formgroup -->

                                        </div>

                                        <!-- <button class="btn btn-primary" type="button" (click) = "addProject(plan)" > Add Project  </button> -->
                                        <button class="btn btn-primary" type="button" (click)="addProject(plan)"> Add Project </button>



                                        <hr>
                                    </div>
                                </collapsible-well>
                            </div>


                        </tbody>
                    </table>

                </div>
            </div>
            <simple-modal #modalProjects closeOnBodyClick="true" elementId="1" title="Add Projects" primaryBtnText="Add Selected Projects">
                <div class="list-group">
                    <project-list [projData]='projData'></project-list>
                </div>
            </simple-modal>
            <simple-modal #modalResources closeOnBodyClick="true" elementId="2" title="Select Resource" primaryBtnText="Add Selected Resources">
                <div class="list-group">
                    <resource-list></resource-list>
                </div>
            </simple-modal>


        </form>
        <hr>
        <br>



        <!-- 
<button class="btn btn-primary" (click)="addResPlan()">Add a Resource Plan</button>
<button class="btn btn-primary" (click)="addProject()">Add a project</button> -->

        <!-- <br>Dirty: {{ resPlans.dirty }}
        <br>Touched: {{ resPlans.touched }} -->

    </div>

